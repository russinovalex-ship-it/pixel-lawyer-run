<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>PixelLawyerRun</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html {
            height: 100%;
            height: -webkit-fill-available; /* –î–ª—è iOS Safari */
        }
        body { 
            width: 100%; 
            min-height: 100vh;
            min-height: -webkit-fill-available; /* –î–ª—è iOS Safari */
            font-family: 'Press Start 2P', monospace; 
            background: #FFFFFF;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }
        .game-wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #FFFFFF;
        }
        .screen { 
            display: none; 
            width: 100%; 
            height: 100%; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            overflow-y: auto; 
            overflow-x: hidden;
            padding: 10px;
            box-sizing: border-box;
        }
        .screen.active { display: flex; }
        .game-screen {
            overflow: hidden;
        }

        /* MENU */
        .title-main {
            font-size: 3rem;
            color: #000000;
            text-align: center;
            margin-bottom: 20px;
            animation: blink 0.3s infinite;
            text-shadow: 2px 2px 0px #DDDDDD;
        }
        @keyframes blink {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(1px, 1px); }
        }
        .tagline {
            font-size: 0.8rem;
            color: #000000;
            margin-bottom: 30px;
            text-align: center;
        }
        .career-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .career-btn {
            width: 150px;
            height: 120px;
            border: 3px solid #000000;
            background: #FFFFFF;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            font-size: 0.7rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 3px 3px 0px #000000;
            transition: all 0.1s;
        }
        .career-btn:hover {
            transform: translate(-2px, -2px);
            box-shadow: 5px 5px 0px #000000;
        }
        .career-emoji { font-size: 2rem; }
        .career-name { font-weight: bold; }
        .career-diff { font-size: 0.5rem; color: #666666; }

        /* WARNING SCREEN */
        .warning-box {
            border: 4px solid #000000;
            padding: 40px;
            background: #FFFFFF;
            max-width: 600px;
            box-shadow: 5px 5px 0px #000000;
            text-align: center;
        }
        .warning-title {
            font-size: 1.5rem;
            color: #FF0000;
            margin-bottom: 20px;
        }
        .warning-text {
            font-size: 0.8rem;
            color: #000000;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        .disclaimer-box {
            border: 2px solid #CCCCCC;
            padding: 15px;
            background: #F5F5F5;
            font-size: 0.6rem;
            color: #333333;
            margin-bottom: 30px;
            text-align: left;
            line-height: 1.4;
        }
        .disclaimer-title { font-weight: bold; margin-bottom: 8px; }
        .button-row {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .btn {
            padding: 15px 30px;
            border: 3px solid #000000;
            background: #FFFFFF;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            font-size: 0.7rem;
            box-shadow: 3px 3px 0px #000000;
            transition: all 0.1s;
        }
        .btn:hover {
            transform: translate(-1px, -1px);
            box-shadow: 4px 4px 0px #000000;
        }
        .btn.yes { border-color: #00CC00; color: #00CC00; }
        .btn.no { border-color: #FF0000; color: #FF0000; }

        /* GAME SCREEN */
        .game-header {
            width: 100%;
            padding: 10px 20px;
            border-bottom: 3px solid #000000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.7rem;
            background: #FFFFFF;
            flex-shrink: 0; /* –ù–µ —Å–∂–∏–º–∞–µ—Ç—Å—è */
        }
        .game-stats {
            display: flex;
            gap: 15px;
        }
        .stat {
            border: 2px solid #000000;
            padding: 5px 10px;
            background: #FFFFFF;
            color: #000000;
        }
        .stat.money {
            border-color: #FFD700;
            color: #FFD700;
        }
        .career-info {
            font-size: 0.75rem;
            text-align: center;
        }
        .exit-btn {
            padding: 8px 15px;
            border: 2px solid #FF0000;
            background: #FFFFFF;
            color: #FF0000;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            font-size: 0.6rem;
            box-shadow: 2px 2px 0px #FF0000;
        }
        .exit-btn:hover { transform: translate(-1px, -1px); }

        .game-canvas {
            flex: 1;
            border: 3px solid #000000;
            background: #FFFFFF;
            margin: 0;
            box-shadow: none;
            min-height: 200px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: none; /* –û—Ç–∫–ª—é—á–∞–µ–º –∂–µ—Å—Ç—ã –¥–ª—è canvas */
            overflow: hidden;
        }
        canvas {
            display: block;
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            background: #FFFFFF;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            image-rendering: -moz-crisp-edges;
            touch-action: none;
        }

        .game-footer {
            width: 100%;
            padding: 10px;
            border-top: 3px solid #000000;
            text-align: center;
            font-size: 0.65rem;
            background: #FFFFFF;
            flex-shrink: 0; /* –ù–µ —Å–∂–∏–º–∞–µ—Ç—Å—è */
        }

        /* GAMEOVER */
        .gameover-box {
            border: 4px solid #000000;
            padding: 40px;
            background: #FFFFFF;
            max-width: 600px;
            box-shadow: 5px 5px 0px #000000;
            text-align: center;
        }
        .gameover-title {
            font-size: 2rem;
            color: #FF0000;
            margin-bottom: 30px;
        }
        .gameover-stats {
            border: 2px solid #000000;
            padding: 20px;
            background: #F5F5F5;
            margin-bottom: 20px;
            font-size: 0.7rem;
            text-align: left;
            line-height: 1.8;
        }
        .stat-line {
            display: flex;
            justify-content: space-between;
            padding-bottom: 10px;
            border-bottom: 1px solid #CCCCCC;
        }
        .gameover-quote {
            font-size: 0.8rem;
            color: #FF0000;
            border: 2px solid #FF0000;
            padding: 15px;
            margin-bottom: 30px;
            background: #FFF0F0;
        }
        .gameover-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø */
        @media (max-width: 768px) {
            .title-main {
                font-size: 2rem;
                margin-bottom: 15px;
            }
            .tagline {
                font-size: 0.6rem;
                margin-bottom: 20px;
            }
            .career-grid {
                gap: 15px;
                margin-bottom: 20px;
            }
            .career-btn {
                width: 120px;
                height: 100px;
                font-size: 0.6rem;
            }
            .career-emoji {
                font-size: 1.5rem;
            }
            .game-header {
                padding: 5px 8px;
                font-size: 0.5rem;
                border-bottom-width: 2px;
            }
            .game-stats {
                gap: 5px;
            }
            .stat {
                padding: 3px 6px;
                font-size: 0.5rem;
                border-width: 1px;
            }
            .career-info {
                font-size: 0.5rem;
            }
            .exit-btn {
                padding: 4px 8px;
                font-size: 0.45rem;
            }
            .game-canvas {
                margin: 0;
                border-left: none;
                border-right: none;
                min-height: 0;
            }
            .game-footer {
                padding: 5px;
                font-size: 0.45rem;
                border-top-width: 2px;
            }
            .warning-box, .gameover-box {
                padding: 20px;
                margin: 10px;
            }
            .warning-title {
                font-size: 1.2rem;
            }
            .gameover-title {
                font-size: 1.5rem;
            }
        }

        /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 480px) {
            .title-main {
                font-size: 1.5rem;
            }
            .career-btn {
                width: 100px;
                height: 85px;
                font-size: 0.5rem;
            }
            .game-header {
                padding: 4px 6px;
                font-size: 0.45rem;
                flex-wrap: wrap;
                gap: 4px;
            }
            .game-stats {
                gap: 4px;
                flex-wrap: wrap;
            }
            .stat {
                padding: 2px 4px;
                font-size: 0.45rem;
            }
            .career-info {
                font-size: 0.45rem;
                width: 100%;
                text-align: center;
            }
            .exit-btn {
                padding: 3px 6px;
                font-size: 0.4rem;
            }
            .game-canvas {
                margin: 0;
                min-height: 0;
            }
            .game-footer {
                padding: 4px;
                font-size: 0.4rem;
            }
        }
        
        /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (max-width: 768px) and (orientation: landscape) {
            .game-header {
                padding: 3px 6px;
                font-size: 0.4rem;
            }
            .game-stats {
                gap: 3px;
            }
            .stat {
                padding: 2px 4px;
                font-size: 0.4rem;
            }
            .career-info {
                font-size: 0.4rem;
            }
            .exit-btn {
                padding: 2px 5px;
                font-size: 0.35rem;
            }
            .game-footer {
                padding: 3px;
                font-size: 0.35rem;
            }
            .game-canvas {
                margin: 0;
            }
        }

        /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <div class="game-wrapper">
        <!-- MENU SCREEN -->
        <div class="screen menu-screen active">
            <div class="title-main">PIXEL<br>LAWYER<br>RUN</div>
            <div class="career-grid" id="careerGrid"></div>
            <div class="tagline"> –í –Ω–∞—à–µ–º –¢–ì –∫–∞–Ω–∞–ª–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –æ–±–∑–æ—Ä—ã —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –¥–ª—è —é—Ä–∏—Å—Ç–∞ ‚¨áÔ∏è </div>
            <a href="https://t.me/techforlaw" target="_blank" style="border: 2px solid #000000; padding: 10px 20px; font-size: 0.7rem; color: #000000; text-decoration: none; background: #FFFFFF; box-shadow: 2px 2px 0px #000000;">TG: @techforlaw</a>
        </div>

        <!-- WARNING SCREEN -->
        <div class="screen warning-screen">
            <div class="warning-box">
                <div class="warning-title">‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï ‚ö†Ô∏è</div>
                <div class="warning-text" id="warningText"></div>
                <div class="disclaimer-box">
                    <div class="disclaimer-title">üìã –î–∏—Å–∫–ª–µ–π–º–µ—Ä:</div>
                    <div id="disclaimerText"></div>
                </div>
                <div class="button-row">
                    <button class="btn yes" onclick="startGame()">‚úì –°–û–ì–õ–ê–°–ï–ù</button>
                    <button class="btn no" onclick="backToMenu()">‚úó –ü–ï–†–ï–î–£–ú–ê–õ</button>
                </div>
            </div>
        </div>

        <!-- GAME SCREEN -->
        <div class="screen game-screen">
            <div class="game-header">
                <div class="game-stats">
                    <div class="stat">‚ù§Ô∏è <span id="lives">3</span></div>
                    <div class="stat">üìà <span id="score">0</span></div>
                    <div class="stat money">üí∞ $<span id="money">0</span></div>
                </div>
                <div class="career-info">
                    <div id="careerName"></div>
                    <div id="levelName"></div>
                </div>
                <button class="exit-btn" onclick="backToMenu()">EXIT</button>
            </div>
            <div class="game-canvas" id="gameCanvas"></div>
            <div class="game-footer">üéÆ –°–ü–ï–ô–° / –ö–õ–ò–ö = –ü–†–´–ì–ê–ô üí∞ –°–û–ë–ò–†–ê–ô –î–ï–ù–¨–ì–ò</div>
        </div>

        <!-- GAMEOVER SCREEN -->
        <div class="screen gameover-screen">
            <div class="gameover-box">
                <div class="gameover-title">üíÄ GAME OVER üíÄ</div>
                <div class="gameover-stats" id="gameoverStats"></div>
                <div class="gameover-quote" id="gameoverQuote"></div>
                <div class="gameover-buttons">
                    <button class="btn yes" onclick="startGame()">–ò–ì–†–ê–¢–¨ –ï–©–ï</button>
                    <button class="btn no" onclick="backToMenu()">–í –ú–ï–ù–Æ</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION ==========
        const tg = window.Telegram.WebApp;
tg.expand(); // –ö–æ–º–∞–Ω–¥–∞, —á—Ç–æ–±—ã –∏–≥—Ä–∞ –æ—Ç–∫—Ä—ã–ª–∞—Å—å –Ω–∞ –ø–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω
    const canvas = document.getElementById('gameCanvas');
        const CAREERS = {
            inhouse: {
                name: '–ò–ù–•–ê–£–°', emoji: 'üíº',
                warning: '–í—ã–±–∏—Ä–∞—è —ç—Ç–æ—Ç –ø—É—Ç—å, –≤—ã —Ä–∏—Å–∫—É–µ—Ç–µ —É–º–µ—Ä–µ—Ç—å –æ—Ç —Å–∫—É–∫–∏ –∏ –±—é—Ä–æ–∫—Ä–∞—Ç–∏–∏',
                disclaimer: '–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –Ω–µ –≤—Ö–æ–¥—è—Ç –≤ —Ç—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä, –Ω–æ –æ—Ç–Ω–∏–º–∞—é—Ç 90% –≤—Ä–µ–º–µ–Ω–∏.',
                difficulty: 1.0, moneyMulti: 1.0,
                levels: ['–ú–ª–∞–¥—à–∏–π —Å–ø–µ—Ü', '–°–ø–µ—Ü', '–í–µ–¥. —Å–ø–µ—Ü', '–ì–ª. —Å–ø–µ—Ü', '–†—É–∫. –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è', '–†—É–∫. –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è', '–ó–∞–º –ì–î', '–ì–î'],
                obstacles: ['doc', 'pc', 'email', 'phone', 'papers', 'coffee', 'printer', 'boss', 'deadline', 'ppt'],
                quotes: [ '–í—ã –ø–æ–ø–∞–ª–∏ –ø–æ–¥ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ', '–ë—é–¥–∂–µ—Ç –Ω–∞ —é—Ä–∏—Å—Ç–æ–≤ –Ω–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω', '–í—ã –Ω–µ –ø—Ä–æ—à–ª–∏ –∏—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ä–æ–∫', '–û—à–∏–±–∫–∞ 404: –Æ—Ä–∏—Å—Ç not found', '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø—Ä–∞–≤–æ–∫', 'Exel –∑–∞–º–µ–Ω–∏–ª–∏ –Ω–∞ –æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ü–û' ]
            },
            consulting: {
                name: '–ö–û–ù–°–ê–õ–¢–ò–ù–ì', emoji: 'üìä',
                warning: '–í—ã–±–∏—Ä–∞—è —ç—Ç–æ—Ç –ø—É—Ç—å, –≤—ã —Ä–∏—Å–∫—É–µ—Ç–µ –≤—ã–≥–æ—Ä–µ—Ç—å –≤ –ø–µ—Ä–≤—É—é –Ω–µ–¥–µ–ª—é!',
                disclaimer: '–í—ã–≥–æ—Ä–∞–Ω–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ —É–∂–µ –Ω–∞ 3 –º–µ—Å—è—Ü–µ. –í—ã—Ö–æ–¥–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –∏ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–∏. ChatGPT –∑–∞–º–µ–Ω–∏—Ç –≤–∞—Å –±—ã—Å—Ç—Ä–µ–µ.',
                difficulty: 1.8, moneyMulti: 5.0,
                levels: ['–°—Ç–∞–∂—ë—Ä', '–ú–ª–∞–¥—à–∏–π —é—Ä–∏—Å—Ç', '–Æ—Ä–∏—Å—Ç', '–°—Ç–∞—Ä—à–∏–π —é—Ä–∏—Å—Ç', '–°–æ–≤–µ—Ç–Ω–∏–∫', '–ú–ª–∞–¥—à–∏–π –ø–∞—Ä—Ç–Ω–µ—Ä', '–ü–∞—Ä—Ç–Ω—ë—Ä', '–°—Ç–∞—Ä—à–∏–π –ø–∞—Ä—Ç–Ω–µ—Ä'],
                obstacles: ['partner', 'ppt', 'papers', 'phone', 'coffee', 'deadline', 'printer', 'client'],
                quotes: [ '–í—ã –≤—ã–≥–æ—Ä–µ–ª–∏!', '–í—ã –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ KPI!', '–í—ã –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–∏—Å—å –ø–∞—Ä—Ç–Ω–µ—Ä—É', '–í—ã –Ω–µ —Å–¥–µ–ª–∞–ª–∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –∫ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫—É!', 'ChatGPT –≤–∞—Å –∑–∞–º–µ–Ω–∏–ª!', '–î–µ–¥–ª–∞–π–Ω –±—ã–ª –≤—á–µ—Ä–∞!'] 
            },
            gov: {
                name: '–ì–û–°–°–õ–£–ñ–ë–ê', emoji: 'üèõÔ∏è',
                warning: '–û–Ω–æ —Ç–µ–±–µ –Ω–∞–¥–æ? –æ–Ω–æ —Ç–µ–±–µ –Ω–µ –Ω–∞–¥–æ',
                disclaimer: '–ó–∞—Ä–ø–ª–∞—Ç–∞ –Ω–µ —Ä–∞—Å—Ç—ë—Ç, –∑–∞—Ç–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ.',
                difficulty: 0.9, moneyMulti: 0.5,
                levels: ['–ú–ª –æ–ø–µ—Ä', '–û–ø–µ—Ä', '–°—Ç –æ–ø–µ—Ä', '–°—Ç –ø–æ –û–í–î', '–ó–∞–º –Ω–∞—á –æ—Ç–¥–µ–ª–µ–Ω–∏—è', '–ù–∞—á –æ—Ç–¥–µ–ª–µ–Ω–∏—è', '–ó–∞–º. –®–µ—Ñ—É–ª–∏', '–®–µ—Ñ—É–ª—è', '–°—Ç–∞—Ä—à–∏–π –®–µ—Ñ—É–ª—è', '–ü–µ—Ä–≤—ã–π –∑–∞–º', '–ù–∞—á'],
                obstacles: ['papers', 'printer', 'rat', 'boss', 'safe', 'deadline', 'doc'],
                quotes: ['–í—ã –Ω–µ –≤—ã—à–ª–∏ –Ω–∞ —Ä–∞–±–æ—Ç—É –≤ —Å—É–±–±–æ—Ç—É!', '–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ', '–í—ã –Ω–µ –≤—ã—à–ª–∏ –Ω–∞ —Ä–∞–±–æ—Ç—É –≤ –æ—Ç–ø—É—Å–∫', '–í–∞—Å –ª–∏—à–∏–ª–∏ –ø—Ä–µ–º–∏–∏!', '–ü—Ä–æ–≤–µ—Ä–∫–∞ –ü—Ä–æ–∫—É—Ä–∞—Ç—É—Ä—ã –≤—ã—è–≤–∏–ª–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ!', '–ù–°–°!', '–í—ã –Ω–µ –ø—Ä–æ—à–ª–∏ –ø–æ–ª–∏–≥—Ä–∞—Ñ', '–û—Ç —Å—é–¥–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–≤–æ–ª–∏—Ç—å—Å—è!', '–í—ã —É—à–ª–∏ —Å —Ä–∞–±–æ—Ç—ã –≤ 18:00', '–í–∞—Å –ø—Ä–∏–¥–∞–≤–∏–ª–æ —Å–µ–π—Ñ–æ–º', '–ü—Ä–∏–µ—Ö–∞–ª–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞', '–í—ã —É–≤–æ–ª–µ–Ω—ã –∑–∞–¥–Ω–∏–º —á–∏—Å–ª–æ–º']
            },
            private: {
                name: '–ß–ê–°–¢–ù–ê–Ø', emoji: 'üöÄ',
                warning: '–í—ã —Ä–∏—Å–∫—É–µ—Ç–µ —É–º–µ—Ä–µ—Ç—å –≤ –Ω–∏—â–µ—Ç–µ, –∑–∞—Ç–æ –Ω–µ—Ç –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞ (–Ω–æ –µ—Å—Ç—å –Ω–∞–ª–æ–≥–∏)!',
                disclaimer: '–°–≤–æ–±–æ–¥–∞ –µ—Å—Ç—å, –Ω–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–µ—Ç. –ù–∞–ª–æ–≥–æ–≤–∞—è –Ω–µ —Å–ø–∏—Ç. ',
                difficulty: 2, moneyMulti: 1.0,
                levels: ['–°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π', '–ò–ü', '–ò–ü —Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏', '–û—Ç–∫—Ä—ã–ª –û–û–û', '–ü–æ–ø–∞–ª –≤ —Ä–µ–π—Ç–∏–Ω–≥ "–ü—Ä–∞–≤–æ 3000"'],
                obstacles: ['tax', 'money', 'client', 'pc', 'bills', 'deadline'],
                quotes: ['–ö–ª–∏–µ–Ω—Ç –Ω–µ –∑–∞–ø–ª–∞—Ç–∏–ª', '–ü—Ä–∏—à–ª–∞ –Ω–∞–ª–æ–≥–æ–≤–∞—è', '–í–∞–º –Ω–µ—á–µ–º –ø–ª–∞—Ç–∏—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—É', '–ö –≤–∞–º –ø—Ä–∏—à–ª–∞ —Ç—Ä—É–¥–æ–≤–∞—è –∏–Ω—Å–ø–µ–∫—Ü–∏—è', '–í—ã –±–∞–Ω–∫—Ä–æ—Ç! (—Ö–æ—Ä–æ—à–æ, —á—Ç–æ –≤—ã –∑–Ω–∞–µ—Ç–µ —á—Ç–æ –¥–µ–ª–∞—Ç—å, –¥–∞?)', '–í–∞–º –Ω–µ—á–µ–º –ø–ª–∞—Ç–∏—Ç—å –∑–∞ –∞—Ä–µ–Ω–¥—É', '–í–≤–µ–ª–∏ –∞–¥–≤–æ–∫–∞—Ç—Å–∫—É—é –º–æ–Ω–æ–ø–æ–ª–∏—é!', '–û—Ç –≤–∞—Å —É—à–µ–ª –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç', '–°–∞—Ä–∞—Ñ–∞–Ω–Ω–æ–µ —Ä–∞–¥–∏–æ —Å–ª–æ–º–∞–ª–æ—Å—å']
            }
        };

        // ========== ASSETS LOADING ==========
        const ASSETS_PATH = './assets/obstacles/';
        let loadedImages = {};

        // –ú–∞–ø–ø–∏–Ω–≥ –∏–º—ë–Ω –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
        const OBSTACLE_FILE_MAP = {
            'pc': 'computer',
            'ppt': 'powerpoint'
            // –ï—Å–ª–∏ –∏–º—è —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –º–∞–ø–ø–∏–Ω–≥ –Ω–µ –Ω—É–∂–µ–Ω
        };

        function getImageFileName(obstacleName) {
            return OBSTACLE_FILE_MAP[obstacleName] || obstacleName;
        }

        function loadImage(name) {
            return new Promise((resolve, reject) => {
                const fileName = getImageFileName(name);
                const img = new Image();
                img.onload = () => {
                    loadedImages[name] = img;
                    console.log(`‚úì Loaded: ${fileName}.png (${name})`);
                    resolve(img);
                };
                img.onerror = () => {
                    console.warn(`‚úó Not found: ${ASSETS_PATH}${fileName}.png`);
                    loadedImages[name] = null; // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ
                    resolve(null); // –†–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä–æ–º–∏—Å, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥—Ä—É–≥–∏—Ö
                };
                // –£–±–∏—Ä–∞–µ–º crossOrigin –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
                img.src = ASSETS_PATH + fileName + '.png';
            });
        }

        async function preloadAssets() {
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π –∏–∑ –≤—Å–µ—Ö –∫–∞—Ä—å–µ—Ä
            const obstacleNames = new Set();
            Object.values(CAREERS).forEach(career => {
                career.obstacles.forEach(obs => obstacleNames.add(obs));
            });
            
            const namesArray = Array.from(obstacleNames);
            console.log(`–ó–∞–≥—Ä—É–∑–∫–∞ ${namesArray.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π...`);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
            const loadPromises = namesArray.map(name => loadImage(name));
            await Promise.all(loadPromises);
            
            const loadedCount = Object.values(loadedImages).filter(img => img !== null).length;
            console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ: ${loadedCount}/${namesArray.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`);
        }

        // ========== GAME STATE ==========
        let gameState = {
            screen: 'menu',
            career: null,
            score: 0,
            money: 0,
            lives: 3,
            speed: 1.0,
            combo: 0,
            maxCombo: 0,
            timeStart: 0,
            canvas: null,
            ctx: null,
            gameActive: false
        };

        let player = {
            x: 50, y: 0, width: 20, height: 20,
            velocityY: 0, groundY: 0,
            jumpPower: -12,  // –°–∏–ª–∞ –ø—Ä—ã–∂–∫–∞ (–±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–∞—è)
            gravity: 0.5     // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è (–±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è)
        };

        let obstacles = [], bonuses = [];
        let lastObstacleTime = 0, lastBonusTime = 0;
        let nextObstacleDelay = 0; // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è

        // ========== INIT ==========
        function init() {
            preloadAssets().catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤:', err));
            buildCareerButtons();
        }

        function buildCareerButtons() {
            const grid = document.getElementById('careerGrid');
            grid.innerHTML = '';
            for (let [key, career] of Object.entries(CAREERS)) {
                const btn = document.createElement('button');
                btn.className = 'career-btn';
                btn.innerHTML = `<div class="career-emoji">${career.emoji}</div><div class="career-name">${career.name}</div><div class="career-diff">–°–ª–æ–∂–Ω: ${(career.difficulty * 100).toFixed(0)}%</div>`;
                btn.onclick = () => showWarning(key);
                grid.appendChild(btn);
            }
        }

        function showWarning(careerKey) {
            gameState.career = careerKey;
            const c = CAREERS[careerKey];
            document.getElementById('warningText').textContent = `"${c.warning}"`;
            document.getElementById('disclaimerText').textContent = c.disclaimer;
            switchScreen('warning');
        }

        function backToMenu() {
            switchScreen('menu');
        }

        function switchScreen(screenName) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelector(`.${screenName}-screen`).classList.add('active');
            gameState.screen = screenName;
        }

        // ========== GAME ==========
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   (window.innerWidth <= 768);
        }

        function initCanvas() {
            const container = document.getElementById('gameCanvas');
            if (!container) return;
            
            const isMobileDevice = isMobile();
            const isLandscape = window.innerWidth > window.innerHeight;
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
            function calculateCanvasSize() {
                const containerRect = container.getBoundingClientRect();
                
                // –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                let w, h;
                if (isMobileDevice) {
                    // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö: –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ—Å—å –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                    w = Math.floor(containerRect.width) || Math.floor(window.innerWidth);
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—É—é –≤—ã—Å–æ—Ç—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (flex: 1 –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ)
                    h = Math.floor(containerRect.height) || Math.floor(window.innerHeight * 0.75);
                    
                    // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–∫—Å–∏–º—É–º –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
                    if (isLandscape) {
                        // –ê–ª—å–±–æ–º–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è - –º–∏–Ω–∏–º—É–º 150px
                        h = Math.max(150, h);
                    } else {
                        // –ü–æ—Ä—Ç—Ä–µ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è - –º–∏–Ω–∏–º—É–º 200px
                        h = Math.max(200, h);
                    }
                } else {
                    // –î–ª—è –¥–µ—Å–∫—Ç–æ–ø–æ–≤: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                    w = Math.min(Math.floor(containerRect.width - 30), 800);
                    h = Math.min(Math.floor(containerRect.height - 30), 400);
                }
                
                // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã
                w = Math.max(w, 200);
                h = Math.max(h, 150);
                
                return { w, h };
            }
            
            // –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã
            const { w, h } = calculateCanvasSize();
            
            // –ï—Å–ª–∏ canvas —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä—ã
            if (gameState.canvas) {
                gameState.canvas.width = w;
                gameState.canvas.height = h;
            } else {
                gameState.canvas = document.createElement('canvas');
                gameState.canvas.width = w;
                gameState.canvas.height = h;
                container.innerHTML = '';
                container.appendChild(gameState.canvas);
            }
            
            gameState.ctx = gameState.canvas.getContext('2d');
            
            // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è canvas
            gameState.ctx.imageSmoothingEnabled = false;
            if (gameState.ctx.imageSmoothingQuality) {
                gameState.ctx.imageSmoothingQuality = 'low';
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è - –∏—Å–ø–æ–ª—å–∑—É–µ–º 100% –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            gameState.canvas.style.width = '100%';
            gameState.canvas.style.height = '100%';
            
            player.groundY = h * 0.7;
            player.y = player.groundY;
            player.velocityY = 0;
            player.x = 50;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –ø–æ—Å–ª–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–∞–¥—Ä–∞ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
            requestAnimationFrame(() => {
                const { w: newW, h: newH } = calculateCanvasSize();
                if (gameState.canvas && (gameState.canvas.width !== newW || gameState.canvas.height !== newH)) {
                    gameState.canvas.width = newW;
                    gameState.canvas.height = newH;
                    player.groundY = newH * 0.7;
                    player.y = player.groundY;
                }
            });
        }

        function startGame() {
            gameState.score = 0;
            gameState.money = 0;
            gameState.lives = 3;
            gameState.speed = 1.0;
            gameState.combo = 0;
            gameState.maxCombo = 0;
            gameState.gameActive = true;
            gameState.timeStart = Date.now();
            
            obstacles = [];
            bonuses = [];
            lastObstacleTime = Date.now();
            lastBonusTime = Date.now();
            nextObstacleDelay = 0; // –°–±—Ä–æ—Å –∑–∞–¥–µ—Ä–∂–∫–∏
            lastFrameTime = performance.now(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
            
            initCanvas();
            updateUI();
            switchScreen('game');
            requestAnimationFrame(gameLoop);
        }

        function updateUI() {
            document.getElementById('lives').textContent = gameState.lives;
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('money').textContent = gameState.money;
            
            const c = CAREERS[gameState.career];
            const levelIdx = Math.min(Math.floor(gameState.score / 5), c.levels.length - 1);
            document.getElementById('careerName').textContent = `${c.emoji} ${c.name}`;
            document.getElementById('levelName').textContent = `${c.levels[levelIdx]} (${levelIdx + 1}/${c.levels.length})`;
        }

        let lastFrameTime = 0;
        const targetFPS = 60;
        const frameInterval = 1000 / targetFPS;

        function gameLoop(currentTime) {
            if (!gameState.gameActive) return;
            
            // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è FPS –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            const elapsed = currentTime - lastFrameTime;
            if (elapsed >= frameInterval) {
                update();
                render();
                lastFrameTime = currentTime - (elapsed % frameInterval);
            }
            
            requestAnimationFrame(gameLoop);
        }

        function update() {
            const c = CAREERS[gameState.career];
            const canv = gameState.canvas;
            
            // PHYSICS
            player.y += player.velocityY;
            if (player.y < player.groundY) {
                player.velocityY += player.gravity; // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—É—é –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—é
            } else {
                player.y = player.groundY;
                player.velocityY = 0;
            }
            
            // SPAWN OBSTACLES (—Å —Ä–∞–Ω–¥–æ–º–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏)
            const baseInterval = 1500 / c.difficulty;
            const randomVariation = baseInterval * 0.6; // ¬±60% –≤–∞—Ä–∏–∞—Ü–∏—è
            const minInterval = baseInterval * 0.4; // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
            const maxInterval = baseInterval * 1.6; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
            
            if (nextObstacleDelay === 0) {
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
                nextObstacleDelay = minInterval + Math.random() * (maxInterval - minInterval);
            }
            
            if (Date.now() - lastObstacleTime > nextObstacleDelay) {
                const type = c.obstacles[Math.floor(Math.random() * c.obstacles.length)];
                obstacles.push({
                    x: canv.width,
                    type: type,
                    width: 32,
                    height: 32
                });
                lastObstacleTime = Date.now();
                nextObstacleDelay = 0; // –°–±—Ä–æ—Å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
            }
            
            // SPAWN BONUSES
            if (Date.now() - lastBonusTime > (4000 + Math.random() * 3000)) {
                // –í—ã—á–∏—Å–ª—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≤—ã—Å–æ—Ç—É –ø—Ä—ã–∂–∫–∞
                // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ = (jumpPower¬≤) / (2 * gravity)
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º Math.abs, —Ç–∞–∫ –∫–∞–∫ jumpPower –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π
                const jumpSpeed = Math.abs(player.jumpPower);
                const maxJumpHeight = (jumpSpeed * jumpSpeed) / (2 * player.gravity);
                
                // –ú–æ–Ω–µ—Ç–∫–∏ —Ä–∞–∑–º–µ—â–∞–µ–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–æ—Å—è–≥–∞–µ–º–æ—Å—Ç–∏ –ø—Ä—ã–∂–∫–∞
                // –í —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç canvas Y —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤–Ω–∏–∑, –ø–æ—ç—Ç–æ–º—É:
                // - groundY - —ç—Ç–æ –ø–æ–∑–∏—Ü–∏—è –∑–µ–º–ª–∏ (–±–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
                // - –ú–æ–Ω–µ—Ç–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã—à–µ, —Ç–æ –µ—Å—Ç—å —Å –º–µ–Ω—å—à–∏–º Y
                // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞: —á—É—Ç—å –≤—ã—à–µ –∑–µ–º–ª–∏ (groundY - 30)
                // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞: 85% –æ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã—Å–æ—Ç—ã –ø—Ä—ã–∂–∫–∞ (—á—Ç–æ–±—ã –±—ã–ª–æ –ª–µ–≥—á–µ –¥–æ—Å—Ç–∞—Ç—å)
                const minHeight = player.groundY - 30; // –ß—É—Ç—å –≤—ã—à–µ –∑–µ–º–ª–∏
                const maxHeight = player.groundY - maxJumpHeight * 0.85; // 85% –æ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã—Å–æ—Ç—ã –ø—Ä—ã–∂–∫–∞
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—É—é –≤—ã—Å–æ—Ç—É –≤ —ç—Ç–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
                const bonusY = maxHeight + Math.random() * (minHeight - maxHeight);
                
                bonuses.push({
                    x: canv.width,
                    y: bonusY
                });
                lastBonusTime = Date.now();
            }
            
            // UPDATE OBSTACLES
            for (let i = obstacles.length - 1; i >= 0; i--) {
                obstacles[i].x -= gameState.speed * 3;
                const obsTop = player.groundY - obstacles[i].height;
                
                if (player.x + player.width > obstacles[i].x && 
                    player.x < obstacles[i].x + obstacles[i].width &&
                    player.y > obsTop - 5 &&
                    player.y < player.groundY + 5) {
                    gameState.lives--;
                    gameState.combo = 0;
                    if (gameState.lives <= 0) {
                        endGame();
                        return;
                    }
                    obstacles.splice(i, 1);
                } else if (obstacles[i].x < -50) {
                    gameState.score++;
                    gameState.combo++;
                    gameState.maxCombo = Math.max(gameState.maxCombo, gameState.combo);
                    gameState.speed = Math.min(5, 1.0 + gameState.score * 0.05 * c.difficulty);
                    obstacles.splice(i, 1);
                }
            }
            
            // UPDATE BONUSES
            for (let i = bonuses.length - 1; i >= 0; i--) {
                bonuses[i].x -= gameState.speed * 3;
                
                if (player.x + player.width > bonuses[i].x &&
                    player.x < bonuses[i].x + 15 &&
                    player.y + player.height > bonuses[i].y - 15 &&
                    player.y < bonuses[i].y + 15) {
                    gameState.money += Math.floor(10 * c.moneyMulti);
                    gameState.combo++;
                    bonuses.splice(i, 1);
                } else if (bonuses[i].x < -50) {
                    bonuses.splice(i, 1);
                }
            }
            
            updateUI();
        }

        function render() {
            const ctx = gameState.ctx;
            const canv = gameState.canvas;
            
            // –ë–µ–ª—ã–π —Ñ–æ–Ω
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, canv.width, canv.height);
            
            // –õ–∏–Ω–∏—è –∑–µ–º–ª–∏
            ctx.strokeStyle = '#999999';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, player.groundY);
            ctx.lineTo(canv.width, player.groundY);
            ctx.stroke();
            
            // DRAW PLAYER
            ctx.fillStyle = '#000000';
            ctx.fillRect(player.x + 8, player.y - 18, 4, 4);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(player.x + 9, player.y - 17, 1, 1);
            ctx.fillStyle = '#000000';
            ctx.fillRect(player.x + 8, player.y - 13, 4, 3);
            ctx.fillRect(player.x + 7, player.y - 10, 6, 5);
            ctx.fillRect(player.x + 7, player.y - 5, 2, 1);
            ctx.fillRect(player.x + 11, player.y - 5, 2, 1);
            
            // OBSTACLES
            obstacles.forEach(obs => {
                const img = loadedImages[obs.type];
                if (img && img.complete && img.naturalWidth > 0) {
                    // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ assets/obstacles
                    ctx.drawImage(img, obs.x, player.groundY - obs.height, obs.width, obs.height);
                } else {
                    // Fallback: —Ä–∏—Å—É–µ–º –ø—Ä–æ—Å—Ç–æ–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å
                    ctx.fillStyle = '#FF6B6B';
                    ctx.strokeStyle = '#000000';
                    ctx.lineWidth = 2;
                    ctx.fillRect(obs.x, player.groundY - obs.height, obs.width, obs.height);
                    ctx.strokeRect(obs.x, player.groundY - obs.height, obs.width, obs.height);
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–∏–ø –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è —Ç–µ–∫—Å—Ç–æ–º
                    ctx.fillStyle = '#000000';
                    ctx.font = 'bold 8px Courier';
                    ctx.textAlign = 'center';
                    ctx.fillText(obs.type.substring(0, 3), obs.x + obs.width / 2, player.groundY - obs.height / 2);
                }
            });
            
            // BONUSES
            bonuses.forEach(bonus => {
                ctx.fillStyle = '#FFD700';
                ctx.strokeStyle = '#FFA500';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(bonus.x + 8, bonus.y, 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                ctx.fillStyle = '#FF8C00';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('$', bonus.x + 8, bonus.y);
            });
            
            ctx.fillStyle = '#000000';
            ctx.font = 'bold 10px Courier';
            ctx.textAlign = 'left';
            ctx.fillText(`Score: ${gameState.score}`, 10, 20);
            if (gameState.combo > 1) {
                ctx.fillStyle = '#00AA00';
                ctx.fillText(`COMBO x${gameState.combo}`, 10, 35);
            }
        }

        function endGame() {
            gameState.gameActive = false;
            const elapsed = Math.floor((Date.now() - gameState.timeStart) / 1000);
            const c = CAREERS[gameState.career];
            const quote = c.quotes[Math.floor(Math.random() * c.quotes.length)];
            
            document.getElementById('gameoverStats').innerHTML = `
                <div class="stat-line"><span>–ö–∞—Ä—å–µ—Ä–∞:</span><span>${c.emoji} ${c.name}</span></div>
                <div class="stat-line"><span>–ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π:</span><span>${gameState.score}</span></div>
                <div class="stat-line"><span>–ú–∞–∫—Å –∫–æ–º–±–æ:</span><span>üî• ${gameState.maxCombo}</span></div>
                <div class="stat-line"><span>–í—Ä–µ–º—è:</span><span>${elapsed}—Å</span></div>
                <div class="stat-line"><span>–ó–∞—Ä–∞–±–æ—Ç–æ–∫:</span><span>üí∞ $${gameState.money}</span></div>
            `;
            
            document.getElementById('gameoverQuote').textContent = `"${quote}"`;
            switchScreen('gameover');
        }

        // ========== INPUT ==========
        let lastJumpTime = 0;
        const jumpCooldown = 50; // –ó–∞—â–∏—Ç–∞ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä—ã–∂–∫–æ–≤ (50ms)

        function handleJump() {
            if (!gameState.gameActive) return false;
            const now = Date.now();
            if (now - lastJumpTime < jumpCooldown) return false; // –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞
            
            if (player.y >= player.groundY - 1) {
                player.velocityY = player.jumpPower;
                lastJumpTime = now;
                return true;
            }
            return false;
        }

        document.addEventListener('keydown', (e) => {
            if ((e.key === ' ' || e.code === 'Space')) {
                e.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                handleJump();
            }
        });

        document.addEventListener('mousedown', (e) => {
            if (!gameState.gameActive || !gameState.canvas) return;
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∏–∫ –±—ã–ª –ø–æ canvas –∏–ª–∏ –∏–≥—Ä–æ–≤–æ–π –æ–±–ª–∞—Å—Ç–∏
            const rect = gameState.canvas.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const clickY = e.clientY - rect.top;
            
            if (clickX >= 0 && clickX <= rect.width && clickY >= 0 && clickY <= rect.height) {
                handleJump();
            }
        });

        // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Å–∞–Ω–∏–π –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
        let touchStartY = 0;
        let touchStartTime = 0;
        let isTouchActive = false;
        
        document.addEventListener('touchstart', (e) => {
            if (!gameState.gameActive) return;
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª –∏ –∑—É–º —Ç–æ–ª—å–∫–æ –≤ –∏–≥—Ä–æ–≤–æ–π –æ–±–ª–∞—Å—Ç–∏
            const rect = gameState.canvas ? gameState.canvas.getBoundingClientRect() : null;
            if (rect) {
                const touch = e.touches[0];
                const touchX = touch.clientX - rect.left;
                const touchY = touch.clientY - rect.top;
                
                // –ï—Å–ª–∏ –∫–∞—Å–∞–Ω–∏–µ –≤ –æ–±–ª–∞—Å—Ç–∏ canvas, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
                if (touchX >= 0 && touchX <= rect.width && touchY >= 0 && touchY <= rect.height) {
                    e.preventDefault();
                    touchStartY = touch.clientY;
                    touchStartTime = Date.now();
                    isTouchActive = true;
                    handleJump();
                }
            } else {
                // –ï—Å–ª–∏ canvas –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω, –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
                e.preventDefault();
                handleJump();
            }
        }, { passive: false });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –∑—É–º –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º –∫–∞—Å–∞–Ω–∏–∏
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (gameState.gameActive && isTouchActive) {
                e.preventDefault();
                isTouchActive = false;
            }
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –¥–≤–æ–π–Ω–æ–π —Ç–∞–ø –¥–ª—è –∑—É–º–∞
            if (now - lastTouchEnd < 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, { passive: false });
        
        document.addEventListener('touchcancel', (e) => {
            if (gameState.gameActive) {
                isTouchActive = false;
            }
        }, { passive: false });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
        document.addEventListener('contextmenu', (e) => {
            if (gameState.gameActive) {
                e.preventDefault();
            }
        });

        // ========== RESIZE HANDLER ==========
        let resizeTimeout;
        let lastOrientation = window.orientation !== undefined ? window.orientation : 
                             (window.innerWidth > window.innerHeight ? 90 : 0);
        
        function handleResize() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
                const currentOrientation = window.orientation !== undefined ? window.orientation : 
                                          (window.innerWidth > window.innerHeight ? 90 : 0);
                
                if (gameState.gameActive && gameState.canvas) {
                    // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º canvas –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –∏–ª–∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
                    initCanvas();
                }
                
                lastOrientation = currentOrientation;
            }, 250); // Debounce –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
        }
        
        window.addEventListener('resize', handleResize);
        window.addEventListener('orientationchange', () => {
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –±—Ä–∞—É–∑–µ—Ä—É –Ω—É–∂–Ω–æ –≤—Ä–µ–º—è –Ω–∞ –ø–µ—Ä–µ—Å—á–µ—Ç
            setTimeout(handleResize, 500);
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ viewport –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (–∫–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è/—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–¥—Ä–µ—Å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)
        let lastViewportHeight = window.innerHeight;
        function handleViewportChange() {
            const currentHeight = window.innerHeight;
            if (Math.abs(currentHeight - lastViewportHeight) > 50) {
                // –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –∞–¥—Ä–µ—Å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)
                if (gameState.gameActive && gameState.canvas) {
                    setTimeout(() => {
                        initCanvas();
                    }, 100);
                }
            }
            lastViewportHeight = currentHeight;
        }
        
        window.addEventListener('resize', handleViewportChange);

        // ========== START ==========
        init();
    </script>
</body>
</html>